<!doctype html><html lang=en-uk><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.148.2"><title>BEye Project | Marco Bacis</title><meta name=description content="BEye was a project developed during my last year of bachelor at Politecnico di Milano, together with Lara Cavinato and Irene Fidone.
It consists in an FPGA-accelerated application for retinal vessels segmentation, which aims at improving the performance (speed) of screening tests.
Context
Diabetic Retinopathy (DR) is an eye disorder due to diabetes compensation, and consists in the rapid growth of new anomalous vessels in the retina micro-circulation and the creation of micro-aneurysm and exudates or hemorrhages.
It is a degenerative diseases that pass through three stages:"><meta name=twitter:card content="summary"><meta name=twitter:title content="BEye Project"><meta name=twitter:description content="BEye was a project developed during my last year of bachelor at Politecnico di Milano, together with Lara Cavinato and Irene Fidone. It consists in an FPGA-accelerated application for retinal vessels segmentation, which aims at improving the performance (speed) of screening tests.
Context Diabetic Retinopathy (DR) is an eye disorder due to diabetes compensation, and consists in the rapid growth of new anomalous vessels in the retina micro-circulation and the creation of micro-aneurysm and exudates or hemorrhages. It is a degenerative diseases that pass through three stages:"><meta property="og:url" content="https://marcobacis.com/static/projects/beye/"><meta property="og:site_name" content="Marco Bacis"><meta property="og:title" content="BEye Project"><meta property="og:description" content="BEye was a project developed during my last year of bachelor at Politecnico di Milano, together with Lara Cavinato and Irene Fidone. It consists in an FPGA-accelerated application for retinal vessels segmentation, which aims at improving the performance (speed) of screening tests.
Context Diabetic Retinopathy (DR) is an eye disorder due to diabetes compensation, and consists in the rapid growth of new anomalous vessels in the retina micro-circulation and the creation of micro-aneurysm and exudates or hemorrhages. It is a degenerative diseases that pass through three stages:"><meta property="og:locale" content="en_uk"><meta property="og:type" content="article"><meta property="article:section" content="static"><meta property="article:modified_time" content="2025-08-25T17:33:57+02:00"><link href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css rel=stylesheet integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><script src=https://kit.fontawesome.com/06d3e22684.js crossorigin=anonymous></script><link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel=stylesheet><link href=/css/main.css rel=stylesheet><script defer src=https://umami.marcobacis.com/script.js data-website-id=435d89b9-0e4c-4831-9214-edf318b03138></script><link rel=alternate type=application/rss+xml href=https://marcobacis.com/blog/index.xml title="Marco Bacis Blog"></head><body><nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down"><div class="container pr-0"><a class=navbar-brand href=https://marcobacis.com//><span style=font-family:Righteous>Marco Bacis</span>
</a><button class=navbar-toggler type=button aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarMediumish><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/>Home</a></li><li class=nav-item><a class=nav-link href=/now>Now</a></li><li class=nav-item><a class=nav-link href=/blog>Blog</a></li><li class=nav-item><a class=nav-link href=/projects>Projects</a></li><li class=nav-item><a class=nav-link href=/publications>Publications</a></li><li class=nav-item><a class=nav-link href=/cv>CV</a></li><li class=nav-item><a class=nav-link href=/about>About</a></li></ul></div></div></nav><div class=site-content><div class=container><div class=main-content><div class=container><div class=row><div class=col-md-1></div><div class=col-md-10><div class=mainheading><h1 class=posttitle>BEye Project</h1></div><div class=article-post><p>BEye was a project developed during my last year of bachelor at Politecnico di Milano, together with Lara Cavinato and Irene Fidone.
It consists in an FPGA-accelerated application for retinal vessels segmentation, which aims at improving the performance (speed) of screening tests.</p><h2 id=context>Context</h2><p><strong>Diabetic Retinopathy (DR)</strong> is an eye disorder due to diabetes compensation, and consists in the rapid growth of new anomalous vessels in the retina micro-circulation and the creation of micro-aneurysm and exudates or hemorrhages.
It is a degenerative diseases that pass through three stages:</p><ul><li><p><strong>Non-proliferative</strong> with symptoms (such as edemas, micro aneurysms and a mild loss of sight/blurring) which can be detected by using <em>screening tests</em></p></li><li><p><strong>Proliferative</strong> stage, characterized by abnormal new blood vessels (neovasculari- sation) and bursted/bleeding and blurred vision with the presence of vitreous hemorrhages. In this phase, the situation gets more complicated and even the cures become more intrusive.</p></li><li><p><strong>Blindness</strong></p></li></ul><p>The percentage of people who suffer from this pathology is more and more increasing, and screening tests are the best way to detect the disease before the proliferative stage.
However, the algorithms used to identify DR are either too slow or costly to be extensively used.
Here comes the opportunity tackled by BEye.</p><p>The project aims at making screening tests easy and fast, by using an embedded FPGA board with a fast vessels segmentation algorithm synthesized on it.
Even if the work done by us was just a prototype of the algorithm synthesized on FPGA, it represents a good use case for FPGAs, and makes us think about its applications.
For example, the FPGA could be associated with a high-speed camera to obtain a live segmentation and to check it with the previous images (or other similar patients). A mobile device like this would make screening tests easy to perform even where there aren&rsquo;t near ophtalmologists and vision centers.</p><h2 id=vessels-segmentation-algorithm>Vessels Segmentation Algorithm</h2><p>The algorithm for vessels segmentation performs a series of steps, each one implemented by a 2D filter on the input image.</p><p>The first phase is the preprocessing of the image with a 3x3 median blur, in order to remove <em>salt and pepper</em> noise which could impact on the next edge detection filters.</p><p>The vessel detection filter is instead implemented by performing a parallel filter of the image with 13 different kernels (16x16 sliding windows), taking the maximum value and then giving the output to a 9x9 adaptive threshold filter.</p><p>False positives are removed by employing a simple blob detection filter, implemented as a two-pass 2D filter over the image (takes the down and right pixels and get the maximum size connected component of black pixels).</p><p>Finally, the results are filtered for a last time with a 11x11 adaptive threshold.</p><p><img class="img-fluid image" src=/beye/algorithm.png title alt></figure></p><h2 id=why-fpga>Why FPGA?</h2><p>As explained in the preceding description, the algorithm is composed of a series of 2D-filtering steps.
A standard CPU (a single core) executes and runs one instruction at a time, and can perform one access to memory on each cycle.
This means that, for each output pixel, the CPU would have to access the central and neighboring pixels each time, and even with a cache, it will mean K x K instructins for a single output pixel for a single filter, for each image.</p><p>An FPGA is instead like a blank canvas, in which instructions and <em>local</em> data accesses can be freely arranged (that&rsquo;s why it this kind of execution is called <em>spatial computation</em>).
The main advantage of using a FPGA in this project was then that it allows to arrange the on-chip fast memories (BRAMs) in order to parallelize the reading and execution of most of the filter operations.
In this way, <em>data locality</em> is exploited by using the local memory for the local elements (neighbors), whithout waiting for the external memory (DRAM) each time.</p><p>The filters&rsquo; implementation takes advantage of this by creating a <em>hardware sliding window</em> (multipliers interleaved by registers and FIFO queues) in order to have a linear memory access (each pixel is accessed just one time from the main memory) for all the filters that can fit on the chip.</p><p>Also, the FPGA reconfigurability means that the design can be changed when the algorithm is updated, which happens often for biomedical applications.</p><h2 id=results>Results</h2><p>We created a prototype of the system by implementing the filters described in the algorithm section.
We first implemented them in software (using python and the opencv libraries), then synthesized all of them for FPGA using Vivado HLS and Vivado IPI.</p><p>Vivado HLS is a <em>high-level synthesis</em> software from Xilinx that translate C or C++ code into Verilog/VHDL and packages the resulting kernel into an IP core.
Vivado IPI (IP integrator) is instead an EDA tool to connect, synthesize and place these IP blocks for a specified FPGA model (in our case the Xilinx Zynq-7020 included in <a href=zedboard.org>Zedboard</a>).
It can also acts as a standard FPGA tool by directly writing HDL code for the blocks and the connections.
Finally, Xilinx SDK was used to run the management software on the on-board ARM processor, used to manage the pictures and to send and receive them from the programmable logic.</p><p>In short, the FPGA implementation outperformed (by <strong>6X</strong>) the sofwtare implementation (running on a 2012 Intel core-i7), and was also more energy efficient.
We compared the work also the other state of art implementations and ours was faster!
This allowed us to arrive to the Xilinx Open Hardware competition finals, and to publish a paper in the EMBC 2017 conference (a high-ranked biomedical conference) in South Korea.</p><h2 id=media-and-contacts>Media and Contacts</h2><p>Xilinx Open Hardware 2016 Finalists - <a href=http://www.openhw.eu/2016-finalists.html target=_blank>link</a></p><p>Source Code, designs etc&mldr; - <a href=https://bitbucket.org/necst/beye-src target=_blank>Bitbucket</a></p><p>Some videos explaining the project - YouTube <a href="https://www.youtube.com/playlist?list=PLewc2qlpcOueh9xMhoDR7G93k6ZZ3pDrO" target=_blank>playlist</a></p><p>Paper published at EMBC 2017 - <a href=/papers/beye_paper.pdf>pdf</a>, <a href=/papers/poster.pdf>poster</a>, <a href=https://ieeexplore.ieee.org/document/8037052/ target=_blank>ieee</a></p><p>Marco Bacis - <a href=mailto:marco.bacis@mail.polimi.it>marco.bacis@mail.polimi.it</a></p><p>Lara Cavinato - <a href=mailto:lara.cavinato@mail.polimi.it>lara.cavinato@mail.polimi.it</a></p><p>Irene Fidone - <a href=mailto:irene.fidone@mail.polimi.it>irene.fidone@mail.polimi.it</a></p><p>Marco D. Santambrogio - <a href=mailto:marco.santambrogio@polimi.it>marco.santambrogio@polimi.it</a></p><p>And here are a few slides showing the project (presented at the Stanford OTL office in May 2018):</p><div class=container><div class=row><div class=col></div><div class="col-12 col-md-8"><div style=left:0;width:100%;height:0;position:relative;padding-bottom:75.0019%;padding-top:38px><iframe src=https://www.slideshare.net/slideshow/embed_code/key/DvdxmrKlkBa3U style=border:0;top:0;left:0;width:100%;height:100%;position:absolute allowfullscreen scrolling=no></iframe></div></div><div class=col></div></div></div></div></div><div class=col-md-1></div></div></div></div></div><footer class=footer><div class=container><div class=row><div class="col-md-6 col-sm-6 text-center text-lg-left">© Copyright Marco Bacis</div></div></div></footer></div><script src=/js/mediumish.js></script></body></html>